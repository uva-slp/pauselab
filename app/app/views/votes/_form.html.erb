<%= simple_form_for @vote, :url => { :action => "create" } do |vote| %>

  <h2 class="text-lg-left"><%= t 'votes.personal_information' %></h2>

  <div class="row">
    <div class="col-md-6">
      <%= vote.input :first_name, placeholder: (t 'common.first_name_placeholder'), required: true %>
    </div>
    <div class="col-md-6">
      <%= vote.input :last_name, placeholder: (t 'common.last_name_placeholder'), required: true %>
    </div>
    <div class="col-md-6">
      <%= vote.input :phone, placeholder: (t 'common.phone_placeholder'), required: true %>
    </div>
    <div class="col-md-6">
      <%= vote.input :email, placeholder: (t 'common.email_placeholder'), required: true %>
    </div>

    <div class="col-md-12">
      <%= vote.input :street, placeholder: (t 'common.street'), required: true %>
    </div>
  <div>
    <div class="col-md-6">
      <%= vote.input :city, placeholder: (t 'common.city'), required: true %>
    </div>
    <div class="col-md-1">
      <%= vote.input :state, placeholder: (t 'common.state'), required: true %>
    </div>
    <div class="col-md-2">
      <%= vote.input :zip_code, placeholder: (t 'common.zip_code'), required: true %>
    </div>
  </div>


  </div>

  <br>

  <h2 class="text-lg-left"><%= t 'votes.pick_three' %></h2></br>
  <% if @vote.errors[:proposals].any? %>
    <div class="alert alert-danger">
      <%= @vote.errors[:proposals][0] %>
    </div>
  <% end %>
  <div class="selected-proposals"></div>
  <br/>
  <div class="card-columns">

  <%= vote.collection_check_boxes :proposal_ids,
    Proposal.where(status: :approved), :id, :title, item_wrapper_class: 'checkbox-wrapper' do |b| %>

    <div class="card">
      <div class="card-block">

        <h4 class="card-title">
          <%= link_to proposal_path(b.object) do %>
            <%= b.object.title %>
          <% end %>
        </h4>

        <h6 class="card-subtitle text-muted"><%= b.object.user.fullname %></h6>
        <p class="card-text"><%= truncate b.object.essay, length: 100 %></p>

        <div class="form-check">
          <%= b.label(class: "form-check-label btn btn-outline-primary pull-right") {
            b.check_box(class: "form-check-input right-10 proposal-checkbox") + (t 'votes.select') } %>
        </div>

      </div>

      <div class="card-footer text-muted ">
        <span class="pull-left">
          <%= number_to_currency b.object.proposal_budget.cost %>
        </span>
        <span class="pull-right">
          <%= b.object.created_at.strftime("%B %d") %>
        </span>
      </div>

    </div>
  <% end %>

  </div>

  <% unless user_has_admin_access # only embed modal if using recaptcha, when user not admin %>
    <div class="modal fade" id="cat_form" tabindex="-1" role="dialog" aria-labelledby="submitModal">
      <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content" style="width: 340px;">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><%= t 'votes.vote' %></h4>
          </div>
          <div class="modal-body">
            <%= recaptcha_tags %>
          </div>
          <div class="modal-footer">
            <%= vote.submit (t 'votes.vote'), class: 'btn btn-primary pull-right' %>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <div>

    <div class="pull-left">
      <%= t 'votes.honor_pledge' %>
      <%= check_box_tag "honor-pledge" %>
    </div>

    <% if user_has_admin_access %>
      <%= vote.submit (t 'common.submit'), class: 'btn btn-primary pull-right' %>
    <% else # otherwise pull up the modal %>
      <button id="submit-button" type="button" class='btn btn-primary pull-right' data-toggle="modal" data-target="#cat_form"><%= t 'common.submit' %></button>
    <% end %>

  </div>

<% end %>
